# Tool V4.0 使用说明文档

## 概述

Tool V4.0 是一个基于 Python 和 Tkinter 开发的综合工具集，专门用于处理 Excel 文件的各种操作。该工具集包含多个功能模块，主要应用于压焊参数处理、拆板计算、分包管理和二维码生成等工业场景。

### 开发背景
本工具专为工业生产中的数据处理需求而设计，特别针对：
- 压焊工艺参数的数据整理和转换
- 钢板拆板计算的自动化处理
- 产品分包管理的智能化
- 二维码标签的批量生成

### 适用场景
- 钢铁制造业的数据处理
- 压焊工艺参数管理
- 产品包装和物流管理
- 质量追溯系统支持

## 主要功能

### 1. 七号机压焊参数处理
- **功能描述**: 处理压焊参数文件，进行数据转换和转置操作
- **主要特性**:
  - 支持文件拖拽和手动选择
  - 自动拆分合并单元格
  - 参数提取和转换
  - 数据转置输出
  - 智能识别"单边留"和"双边留"参数
  - 自动处理重量计算和单位转换
- **输入要求**:
  - Excel 文件格式 (.xlsx/.xls)
  - 需要 `disposition.xlsx` 配置文件
  - 工作表数据需要符合特定格式
- **处理流程**:
  1. 读取原始压焊参数文件
  2. 拆分合并单元格并填充数据
  3. 提取关键参数（厚度、宽度、长度等）
  4. 计算重量和工艺参数
  5. 生成转置后的参数表
- **输出文件**: 
  - `原文件名_unmerged.xlsx` (中间文件)
  - `压焊参数.xlsx` (处理后的参数文件)
  - `压焊参数_转置.xlsx` (最终转置文件)
- **注意事项**:
  - 处理过程中会自动打开中间文件供用户检查
  - 需要手动保存中间文件后继续处理
  - 最终会删除临时文件

### 2. 拆板工具
- **功能描述**: 根据特定算法进行拆板计算
- **主要特性**:
  - 自动计算拆板数量
  - 处理单边留和双边留情况
  - 生成详细的拆板报告
  - 支持公式计算和样式设置
  - 智能判断拆板条件（≥36块时自动拆板）
  - 自动计算分支数量和重量
  - 支持多种钢材规格处理
- **输入要求**:
  - Excel 文件包含拆板相关数据
  - 需要包含厚度、宽度、长度等关键参数
  - 数据格式需要符合拆板计算要求
- **计算逻辑**:
  - 当拆板数量 ≥ 36 时自动插入拆板行
  - 根据单边留/双边留条件计算分支数量
  - 自动计算重量和面积
  - 生成详细的拆板报告
- **输出文件**: `原文件名_spilt.xlsx`
- **输出内容**:
  - 原始数据 + 拆板数据
  - 自动计算的公式和结果
  - 格式化的表格样式
  - 打印区域设置
- **特殊功能**:
  - 自动合并相同规格的单元格
  - 红色字体标识特殊条件
  - 自动设置打印区域和页面设置

### 3. 分包工具
- **功能描述**: 根据重量和尺寸限制进行智能分包
- **主要特性**:
  - 支持踢脚板参数设置
  - 层高区分功能
  - 自动计算包号
  - 重量和尺寸限制控制
  - 智能分包算法（重量≤2500kg，高度≤980mm）
  - 自动计算密度和体积
  - 支持不同包号格式
- **输入文件**: `待分包文件.xlsx`
- **输入要求**:
  - 文件必须命名为 `待分包文件.xlsx`
  - 包含产品编号、数量、尺寸、重量等数据
  - 数据格式需要符合分包计算要求
- **参数设置**:
  - **包号格式**: 指定包号的前缀字母（如 "ABC" 表示前3个字母）
  - **踢脚板高度**: 踢脚板的高度参数（单位：mm）
  - **踢脚板厚度**: 踢脚板的厚度参数（单位：mm）
  - **有无层高**: 是否按层高进行分包
  - **扁钢高度**: 扁钢的高度参数（单位：mm）
- **分包逻辑**:
  - 重量限制：单包重量 ≤ 2500kg
  - 高度限制：单包高度 ≤ 980mm
  - 按包号格式和层高进行分组
  - 自动计算最优分包方案
- **输出文件**: `out.xlsx`
- **输出内容**:
  - 分包后的详细数据
  - 自动生成的包号（P01, P02, ...）
  - 小计和合计信息
  - 格式化的表格样式
- **特殊功能**:
  - 自动插入小计行
  - 灰色背景标识小计行
  - 自动计算汇总数据
  - 支持公式计算

### 4. 二维码整理
- **功能描述**: 生成二维码标签页
- **主要特性**:
  - 支持自定义行列数
  - 可调节缩放比例
  - 自动生成二维码图片
  - 打印优化设置
  - 透明背景二维码
  - 自动布局和排版
  - 支持批量生成
- **输入要求**:
  - Excel 文件包含二维码数据
  - 数据位于指定列（通常为第5列）
  - 支持中文和特殊字符
- **参数设置**:
  - **行数**: 每页的行数（默认：10）
  - **列数**: 每页的列数（默认：3）
  - **缩放**: 打印缩放比例（默认：72%）
  - **结尾行**: 数据结束的行号
- **生成逻辑**:
  - 自动跳过空值和合并板数据
  - 根据行列数自动布局
  - 生成透明背景的二维码
  - 设置打印区域和页面属性
- **输出**: 在原文件中添加"生成二维码"工作表
- **输出内容**:
  - 产品编号和二维码图片
  - 格式化的标签布局
  - 优化的打印设置
  - 自动调整的行高和列宽
- **特殊功能**:
  - 自动识别"合并板"和"拼"相关数据
  - 支持多种二维码纠错级别
  - 自动设置页面边距为0
  - 居中对齐和打印标题行

### 5. 二维码整理（成品二）
- **功能描述**: 专门针对成品二的二维码生成
- **主要特性**:
  - 优化的二维码参数
  - 不同的布局设置
  - 适合特定产品规格
  - 更高的纠错级别（M级别）
  - 更紧凑的布局设计
  - 专门的数据列处理
- **输入要求**:
  - Excel 文件包含成品二相关数据
  - 数据位于第8列（索引7）
  - 支持批量处理
- **参数设置**:
  - **行数**: 每页的行数（默认：10）
  - **列数**: 每页的列数（默认：3）
  - **缩放**: 打印缩放比例（默认：75%）
  - **结尾行**: 数据结束的行号
- **与标准版本的区别**:
  - 使用不同的数据列（第8列 vs 第5列）
  - 更高的二维码纠错级别
  - 不同的列宽设置（29.22 vs 19.89）
  - 不同的缩放比例（75% vs 72%）
  - 不同的打印区域设置
- **输出**: 在原文件中添加"生成二维码"工作表
- **输出内容**:
  - 产品编号和二维码图片
  - 优化的标签布局
  - 适合成品二的打印设置
- **特殊功能**:
  - 自动跳过空值数据
  - 优化的二维码尺寸（120px）
  - 自动设置页面属性
  - 居中对齐和打印标题

## 系统要求

### 软件依赖
- **操作系统**: Windows 10/11 (推荐)
- **Python**: 3.6+ (推荐 3.8+)
- **Tkinter**: 通常随 Python 安装
- **以下 Python 包**:
  - `openpyxl` (≥3.0.0) - Excel 文件读写和处理
  - `pandas` (≥1.3.0) - 数据分析和处理
  - `numpy` (≥1.21.0) - 数值计算和数组操作
  - `qrcode` (≥7.3) - 二维码生成
  - `PIL` (Pillow ≥8.0.0) - 图像处理
  - `tkinterdnd2` (≥0.3.0) - 文件拖拽功能

### 硬件要求
- **内存**: 最少 4GB RAM (推荐 8GB+)
- **存储**: 至少 1GB 可用空间
- **处理器**: 支持 64 位运算
- **显示器**: 分辨率 1024x768 或更高

### 安装依赖

#### 方法一：使用 pip 安装
```bash
pip install openpyxl pandas numpy qrcode pillow tkinterdnd2
```

#### 方法二：使用 requirements.txt
1. 创建 `requirements.txt` 文件，内容如下：
```
openpyxl>=3.0.0
pandas>=1.3.0
numpy>=1.21.0
qrcode>=7.3
pillow>=8.0.0
tkinterdnd2>=0.3.0
```

2. 执行安装命令：
```bash
pip install -r requirements.txt
```

#### 方法三：单独安装（推荐）
```bash
# 基础数据处理包
pip install pandas numpy

# Excel 处理包
pip install openpyxl

# 二维码生成包
pip install qrcode pillow

# 界面拖拽功能包
pip install tkinterdnd2
```

#### 验证安装
```bash
python -c "import openpyxl, pandas, numpy, qrcode, PIL, tkinterdnd2; print('所有依赖包安装成功！')"
```

## 使用说明

### 启动程序

#### 方法一：命令行启动
```bash
python tool_V4.0.py
```

#### 方法二：双击启动
1. 确保 Python 已正确安装并添加到系统环境变量
2. 右键点击 `tool_V4.0.py` 文件
3. 选择"打开方式" → "Python"

#### 方法三：创建快捷方式
1. 右键点击 `tool_V4.0.py` 文件
2. 选择"创建快捷方式"
3. 将快捷方式移动到桌面或开始菜单

#### 启动检查清单
- [ ] Python 环境已正确安装
- [ ] 所有依赖包已安装
- [ ] 程序文件完整（包括配置文件）
- [ ] 有足够的磁盘空间
- [ ] 防火墙允许程序运行

### 界面操作

#### 主界面
程序启动后显示主界面，包含以下功能按钮：
- **七号机压焊参数**: 进入压焊参数处理模块
- **拆板工具**: 进入拆板计算模块
- **分包工具**: 进入分包管理模块
- **二维码整理**: 进入二维码生成模块
- **二维码整理（成品二）**: 进入成品二二维码模块

#### 文件选择方式
1. **手动选择**: 点击"选择文件"按钮
2. **拖拽操作**: 直接将文件拖拽到程序窗口

### 各模块详细操作

#### 七号机压焊参数处理
**详细步骤**:
1. **选择文件**: 
   - 点击"选择文件"按钮或直接拖拽文件到窗口
   - 支持 `.xlsx` 和 `.xls` 格式
   - 确保文件未被其他程序占用

2. **选择工作表**:
   - 从下拉列表中选择包含压焊数据的工作表
   - 确保工作表包含所需的数据列

3. **开始处理**:
   - 点击"确定"按钮开始处理
   - 程序会显示处理进度
   - 处理完成后自动打开中间文件

4. **检查中间文件**:
   - 检查 `原文件名_unmerged.xlsx` 文件
   - 确认数据拆分是否正确
   - 保存文件后关闭

5. **完成转置**:
   - 点击"下一步"按钮
   - 程序自动生成最终转置文件
   - 处理完成后自动打开结果文件

**注意事项**:
- 确保 `disposition.xlsx` 配置文件存在
- 中间文件必须保存后才能继续
- 处理过程中不要关闭程序
- 最终会生成两个文件：参数文件和转置文件

#### 拆板工具
**详细步骤**:
1. **选择文件**:
   - 点击"选择文件"按钮或拖拽文件到窗口
   - 确保文件包含拆板相关数据
   - 检查数据格式是否正确

2. **选择工作表**:
   - 从下拉列表中选择包含拆板数据的工作表
   - 确保工作表包含厚度、宽度、长度等关键参数

3. **开始计算**:
   - 点击"确定"按钮开始拆板计算
   - 程序会自动分析数据并计算拆板方案
   - 处理过程中会显示进度信息

4. **查看结果**:
   - 程序自动生成 `原文件名_spilt.xlsx` 文件
   - 自动打开结果文件供查看
   - 包含原始数据和拆板后的详细报告

**输出内容说明**:
- **原始数据**: 保持原有数据不变
- **拆板数据**: 自动插入的拆板行
- **计算公式**: 自动生成的 Excel 公式
- **样式设置**: 格式化的表格样式
- **打印设置**: 优化的打印区域和页面设置

**特殊功能**:
- 自动识别拆板条件（≥36块）
- 智能计算分支数量和重量
- 自动合并相同规格的单元格
- 红色字体标识特殊条件

#### 分包工具
**详细步骤**:
1. **准备数据文件**:
   - 确保 `待分包文件.xlsx` 文件存在
   - 文件必须包含产品编号、数量、尺寸、重量等数据
   - 检查数据格式是否符合要求

2. **设置参数**:
   - **包号格式**: 输入包号的前缀字母（如 "ABC" 表示前3个字母）
   - **踢脚板高度**: 输入踢脚板高度（单位：mm）
   - **踢脚板厚度**: 输入踢脚板厚度（单位：mm）
   - **有无层高**: 从下拉列表选择"有"或"无"
   - **扁钢高度**: 输入扁钢高度（单位：mm）

3. **开始分包**:
   - 点击"确定"按钮开始智能分包
   - 程序会根据设置的参数进行分包计算
   - 处理过程中会显示进度信息

4. **查看结果**:
   - 程序自动生成 `out.xlsx` 文件
   - 自动打开结果文件供查看
   - 包含分包后的详细数据和汇总信息

**分包逻辑说明**:
- **重量限制**: 单包重量 ≤ 2500kg
- **高度限制**: 单包高度 ≤ 980mm
- **分组规则**: 按包号格式和层高进行分组
- **优化算法**: 自动计算最优分包方案

**输出内容**:
- **分包数据**: 按包号分组的产品数据
- **包号标识**: 自动生成的包号（P01, P02, ...）
- **小计信息**: 每个包的小计数据
- **合计信息**: 总体汇总数据
- **格式样式**: 自动格式化的表格样式

**特殊功能**:
- 自动插入小计行
- 灰色背景标识小计行
- 自动计算汇总数据
- 支持 Excel 公式计算

#### 二维码整理
**详细步骤**:
1. **选择文件**:
   - 点击"选择文件"按钮或拖拽文件到窗口
   - 确保文件包含二维码数据（通常在第5列）
   - 支持中文和特殊字符

2. **选择工作表**:
   - 从下拉列表中选择包含二维码数据的工作表
   - 确保工作表包含所需的数据列

3. **设置参数**:
   - **行数**: 每页的行数（默认：10，建议范围：5-15）
   - **列数**: 每页的列数（默认：3，建议范围：2-4）
   - **缩放**: 打印缩放比例（默认：72%，建议范围：50-100）
   - **结尾行**: 数据结束的行号（必须填写）

4. **生成二维码**:
   - 点击"确定"按钮开始生成
   - 程序会自动处理数据并生成二维码
   - 处理完成后在原文件中添加新工作表

5. **查看结果**:
   - 程序自动打开原文件
   - 查看新添加的"生成二维码"工作表
   - 检查二维码布局和打印效果

**生成逻辑**:
- 自动跳过空值和"合并板"相关数据
- 根据行列数自动布局二维码
- 生成透明背景的二维码图片
- 自动设置打印区域和页面属性

**输出内容**:
- **产品编号**: 显示在产品名称列
- **二维码图片**: 自动生成的二维码
- **标签布局**: 格式化的标签排版
- **打印设置**: 优化的打印参数

**特殊功能**:
- 自动识别"合并板"和"拼"相关数据
- 支持多种二维码纠错级别
- 自动设置页面边距为0
- 居中对齐和打印标题行
- 自动调整行高和列宽

## 文件结构

### 输入文件要求
- **格式**: `.xlsx` 或 `.xls`
- **编码**: UTF-8
- **文件大小**: 建议不超过 50MB
- **特殊文件**:
  - `disposition.xlsx`: 配置参数文件（压焊参数处理必需）
  - `待分包文件.xlsx`: 分包数据文件（分包工具必需）

### 配置文件说明
#### disposition.xlsx
- **Sheet1**: 包含列索引和列名映射
- **Sheet2**: 包含参数转换字典
- **格式要求**: 必须包含特定的数据结构和列名

#### 待分包文件.xlsx
- **数据格式**: 包含产品编号、数量、尺寸、重量等列
- **必需列**: 产品编号、数量、长度、宽度、厚度、重量等
- **数据要求**: 数值型数据必须为数字格式

### 输出文件说明
- **保存位置**: 所有输出文件保存在程序运行目录
- **命名规则**: `原文件名_功能标识.xlsx`
- **文件类型**: 所有输出文件均为 Excel 格式 (.xlsx)
- **临时文件**: 处理过程中的临时文件会自动清理

### 输出文件列表
| 功能模块 | 输出文件名 | 说明 |
|---------|-----------|------|
| 压焊参数处理 | `原文件名_unmerged.xlsx` | 中间文件（需手动保存） |
| 压焊参数处理 | `压焊参数.xlsx` | 处理后的参数文件 |
| 压焊参数处理 | `压焊参数_转置.xlsx` | 最终转置文件 |
| 拆板工具 | `原文件名_spilt.xlsx` | 拆板计算结果 |
| 分包工具 | `out.xlsx` | 分包结果文件 |
| 二维码整理 | 原文件中的新工作表 | "生成二维码"工作表 |

### 文件管理建议
- **备份**: 处理前备份原始文件
- **清理**: 定期清理临时文件和旧版本
- **命名**: 使用有意义的文件名便于管理
- **存储**: 确保有足够的磁盘空间

## 技术特性

### 核心算法
- **列字母转数字**: 支持 Excel 列标识转换
- **合并单元格处理**: 自动拆分并填充数据
- **智能分包算法**: 基于重量和尺寸的优化分配
- **二维码生成**: 支持透明背景和自定义尺寸

### 界面特性
- **现代化 UI**: 使用 ttk 主题
- **拖拽支持**: 支持文件拖拽操作
- **响应式布局**: 自适应窗口大小
- **用户友好**: 中文界面和提示信息

### 数据处理
- **大数据支持**: 可处理大型 Excel 文件
- **错误处理**: 完善的异常处理机制
- **格式保持**: 保持原始文件格式和样式
- **公式支持**: 自动生成 Excel 公式

## 注意事项

### 使用前准备
1. 确保所有依赖包已正确安装
2. 检查输入文件格式是否正确
3. 备份重要数据文件

### 常见问题及解决方案

#### 1. 程序启动问题
**问题**: 程序无法启动或闪退
**解决方案**:
- 检查 Python 环境是否正确安装
- 确认所有依赖包已安装
- 检查防火墙设置
- 以管理员身份运行

#### 2. 文件处理问题
**问题**: 文件无法打开或读取失败
**解决方案**:
- 检查文件是否被其他程序占用
- 确认文件格式为 `.xlsx` 或 `.xls`
- 检查文件是否损坏
- 尝试重新保存文件

**问题**: 处理过程中出现错误
**解决方案**:
- 检查数据格式是否符合要求
- 确认配置文件存在且格式正确
- 检查文件编码是否为 UTF-8
- 查看错误信息并相应调整

#### 3. 性能问题
**问题**: 处理大文件时速度慢或内存不足
**解决方案**:
- 关闭其他不必要的程序
- 增加系统内存
- 使用 SSD 硬盘
- 分批处理大文件

#### 4. 输出问题
**问题**: 输出文件格式不正确
**解决方案**:
- 检查输入数据格式
- 确认参数设置正确
- 重新处理文件
- 检查输出目录权限

#### 5. 二维码生成问题
**问题**: 二维码无法生成或显示异常
**解决方案**:
- 检查数据是否包含特殊字符
- 确认数据长度适合二维码
- 调整二维码参数
- 检查图像处理库是否正确安装

### 性能优化建议

#### 系统优化
- **内存管理**: 处理大文件时关闭其他程序释放内存
- **存储优化**: 使用 SSD 硬盘可显著提升处理速度
- **CPU 优化**: 确保 CPU 性能足够，避免过热降频

#### 文件处理优化
- **文件大小**: 建议单个文件不超过 50MB
- **数据清理**: 处理前清理不必要的空行和格式
- **分批处理**: 大文件可分批处理后合并

#### 程序优化
- **定期清理**: 定期清理临时文件和缓存
- **更新依赖**: 保持依赖包为最新版本
- **监控资源**: 使用任务管理器监控资源使用情况

#### 工作流程优化
- **标准化**: 建立标准的数据格式和命名规范
- **自动化**: 可考虑编写批处理脚本
- **备份策略**: 建立完善的文件备份机制

## 版本历史

### V4.0 (当前版本)
**发布日期**: 2024年
**主要特性**:
- **集成化设计**: 将多个独立工具整合为统一界面
- **现代化 UI**: 使用 ttk 主题，界面更加美观
- **拖拽支持**: 支持文件拖拽操作，提升用户体验
- **增强错误处理**: 完善的异常处理机制
- **优化算法**: 改进数据处理算法，提升性能
- **多语言支持**: 中文界面，适合国内用户

**功能模块**:
- 七号机压焊参数处理
- 拆板工具
- 分包工具
- 二维码整理
- 二维码整理（成品二）

### 历史版本
#### V3.0
- 独立的压焊参数处理工具
- 基础的 Excel 处理功能
- 简单的用户界面

#### V2.0
- 拆板计算功能
- 改进的数据处理算法
- 更好的文件格式支持

#### V1.0
- 基础版本
- 简单的数据处理功能
- 命令行界面

### 兼容性

#### 操作系统兼容性
- **Windows 10**: 完全支持
- **Windows 11**: 完全支持
- **Windows 8.1**: 部分支持（可能存在问题）
- **Windows 7**: 不推荐使用（已停止支持）
- **其他系统**: 仅支持 Windows 系统

#### Excel 格式兼容性
- **Excel 2007+**: 完全支持 (.xlsx 格式)
- **Excel 97-2003**: 部分支持 (.xls 格式)
- **Excel 365**: 完全支持
- **WPS Office**: 部分支持（建议使用 Microsoft Excel）

#### Python 环境兼容性
- **Python 3.8+**: 推荐使用
- **Python 3.6-3.7**: 支持但可能有兼容性问题
- **Python 3.5 及以下**: 不支持
- **Python 2.x**: 不支持

#### 依赖包版本要求
| 包名 | 最低版本 | 推荐版本 |
|------|---------|---------|
| openpyxl | 3.0.0 | 3.1.0+ |
| pandas | 1.3.0 | 1.5.0+ |
| numpy | 1.21.0 | 1.24.0+ |
| qrcode | 7.3 | 7.4+ |
| Pillow | 8.0.0 | 9.5.0+ |
| tkinterdnd2 | 0.3.0 | 0.3.0+ |

## 技术支持

### 错误报告
如遇到问题，请提供以下信息：
- **错误信息**: 完整的错误信息和截图
- **输入文件**: 可重现问题的输入文件示例
- **系统环境**: 操作系统版本、Python 版本、依赖包版本
- **操作步骤**: 详细的操作步骤描述
- **期望结果**: 期望的正确结果

### 联系方式
- **技术支持**: 通过项目维护者联系
- **问题反馈**: 提交详细的错误报告
- **功能建议**: 欢迎提出改进建议

### 更新日志
#### V4.0 更新内容
- **新增功能**: 集成多个工具模块
- **界面改进**: 现代化 UI 设计
- **性能优化**: 提升处理速度和稳定性
- **错误修复**: 修复已知问题和兼容性问题

#### 未来计划
- **功能扩展**: 计划添加更多数据处理功能
- **性能优化**: 持续优化算法和性能
- **用户界面**: 进一步改进用户体验
- **兼容性**: 支持更多系统和格式

### 维护说明
- **定期更新**: 建议定期更新到最新版本
- **备份数据**: 重要数据请及时备份
- **测试环境**: 新版本建议在测试环境验证
- **文档更新**: 文档会随版本更新而更新

---

## 附录

### 快捷键说明
- **Ctrl+S**: 保存文件（在中间文件处理时）
- **Ctrl+O**: 打开文件
- **Ctrl+Z**: 撤销操作（部分功能支持）
- **F5**: 刷新界面

### 数据格式参考
#### 压焊参数文件格式
```
列A: 产品编号
列B: 厚度
列C: 宽度
列D: 长度
列E: 重量
列F: 工艺参数
...
```

#### 拆板数据格式
```
列A: 产品编号
列B: 厚度
列C: 宽度
列D: 长度
列E: 间距
列F: 数量
...
```

#### 分包数据格式
```
列A: 产品编号
列B: 数量
列C: 长度
列D: 宽度
列E: 厚度
列F: 面积
列G: 重量
...
```

### 常见错误代码
- **E001**: 文件无法打开
- **E002**: 工作表不存在
- **E003**: 数据格式错误
- **E004**: 配置文件缺失
- **E005**: 内存不足

---

**注意**: 本工具专为特定工业场景设计，使用前请确保理解相关业务逻辑和数据处理要求。如有疑问，请参考详细的使用说明或联系技术支持。
