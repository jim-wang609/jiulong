# Tool V4.0 使用说明文档

## 概述

Tool V4.0 是一个基于 Python 和 Tkinter 开发的综合工具集，专门用于处理 Excel 文件的各种操作。该工具集包含多个功能模块，主要应用于压焊参数处理、拆板计算、分包管理和二维码生成等工业场景。

### 开发背景
本工具专为九龙机械算料的数据处理需求而设计，特别针对：
- 压焊工艺参数的数据整理和转换
- 钢板拆板计算的自动化处理
- 产品分包管理的智能化
- 二维码标签的批量生成

## 主要功能
- ### 具体查看  [tool_V4.0使用文档.docx](tool_V4.0使用文档.docx)

## 系统要求

### 软件依赖
- **操作系统**: Windows 10/11 (推荐)
- **Python**: 3.6+ (推荐 3.8+)
- **Tkinter**: 通常随 Python 安装
- **以下 Python 包**:
  - `openpyxl` (≥3.0.0) - Excel 文件读写和处理
  - `pandas` (≥1.3.0) - 数据分析和处理
  - `numpy` (≥1.21.0) - 数值计算和数组操作
  - `qrcode` (≥7.3) - 二维码生成
  - `PIL` (Pillow ≥8.0.0) - 图像处理
  - `tkinterdnd2` (≥0.3.0) - 文件拖拽功能

### 硬件要求
- **内存**: 最少 4GB RAM (推荐 8GB+)
- **存储**: 至少 1GB 可用空间
- **处理器**: 支持 64 位运算
- **显示器**: 分辨率 1024x768 或更高

### 安装依赖

#### 方法一：使用 pip 安装
```bash
pip install openpyxl pandas numpy qrcode pillow tkinterdnd2
```

#### 方法二：使用 requirements.txt
1. 创建 `requirements.txt` 文件，内容如下：
```
openpyxl>=3.0.0
pandas>=1.3.0
numpy>=1.21.0
qrcode>=7.3
pillow>=8.0.0
tkinterdnd2>=0.3.0
```

2. 执行安装命令：
```bash
pip install -r requirements.txt
```

#### 方法三：单独安装（推荐）
```bash
# 基础数据处理包
pip install pandas numpy

# Excel 处理包
pip install openpyxl

# 二维码生成包
pip install qrcode pillow

# 界面拖拽功能包
pip install tkinterdnd2
```

#### 验证安装
```bash
python -c "import openpyxl, pandas, numpy, qrcode, PIL, tkinterdnd2; print('所有依赖包安装成功！')"
```

## 使用说明

### 启动程序

#### 方法一：命令行启动
```bash
python tool_V4.0.py
```

#### 方法二：双击启动
1. 确保 Python 已正确安装并添加到系统环境变量
2. 右键点击 `tool_V4.0.py` 文件
3. 选择"打开方式" → "Python"

#### 方法三：用.exe文件直接启动
1. 在下载的软件包里面找到tool_V4.0.py
2. 双击.exe文件

#### 启动检查清单
- [ ] Python 环境已正确安装
- [ ] 所有依赖包已安装
- [ ] 程序文件完整（包括配置文件）
- [ ] 有足够的磁盘空间
- [ ] 防火墙允许程序运行

### 界面操作

#### 主界面
程序启动后显示主界面，包含以下功能按钮：
- **七号机压焊参数**: 进入压焊参数处理模块
- **拆板工具**: 进入拆板计算模块
- **分包工具**: 进入分包管理模块
- **二维码整理**: 进入二维码生成模块
- **二维码整理（成品二）**: 进入成品二二维码模块


## 文件结构

### 输入文件要求
- **格式**: `.xlsx` 或 `.xls`
- **编码**: UTF-8
- **文件大小**: 建议不超过 50MB
- **特殊文件**:
  - `disposition.xlsx`: 配置参数文件（压焊参数处理必需）
  - `待分包文件.xlsx`: 分包数据文件（分包工具必需）

### 配置文件说明
#### disposition.xlsx
- **Sheet1**: 包含列索引和列名映射
- **Sheet2**: 包含参数转换字典
- **格式要求**: 必须包含特定的数据结构和列名

#### 待分包文件.xlsx
- **数据格式**: 包含产品编号、数量、尺寸、重量等列
- **必需列**: 产品编号、数量、长度、宽度、厚度、重量等
- **数据要求**: 数值型数据必须为数字格式

### 输出文件说明
- **保存位置**: 所有输出文件保存在程序运行目录
- **命名规则**: `原文件名_功能标识.xlsx`
- **文件类型**: 所有输出文件均为 Excel 格式 (.xlsx)
- **临时文件**: 处理过程中的临时文件会自动清理

### 输出文件列表
| 功能模块 | 输出文件名 | 说明 |
|---------|-----------|------|
| 压焊参数处理 | `原文件名_unmerged.xlsx` | 中间文件（需手动保存） |
| 压焊参数处理 | `压焊参数.xlsx` | 处理后的参数文件 |
| 压焊参数处理 | `压焊参数_转置.xlsx` | 最终转置文件 |
| 拆板工具 | `原文件名_spilt.xlsx` | 拆板计算结果 |
| 分包工具 | `out.xlsx` | 分包结果文件 |
| 二维码整理 | 原文件中的新工作表 | "生成二维码"工作表 |

### 文件管理建议
- **备份**: 处理前备份原始文件
- **清理**: 定期清理临时文件和旧版本
- **命名**: 使用有意义的文件名便于管理
- **存储**: 确保有足够的磁盘空间

## 技术特性

### 核心算法
- **列字母转数字**: 支持 Excel 列标识转换
- **合并单元格处理**: 自动拆分并填充数据
- **智能分包算法**: 基于重量和尺寸的优化分配
- **二维码生成**: 支持透明背景和自定义尺寸

### 界面特性
- **现代化 UI**: 使用 ttk 主题
- **拖拽支持**: 支持文件拖拽操作
- **响应式布局**: 自适应窗口大小
- **用户友好**: 中文界面和提示信息

### 数据处理
- **大数据支持**: 可处理大型 Excel 文件
- **错误处理**: 完善的异常处理机制
- **格式保持**: 保持原始文件格式和样式
- **公式支持**: 自动生成 Excel 公式

## 注意事项

### 使用前准备
1. 确保所有依赖包已正确安装
2. 检查输入文件格式是否正确
3. 备份重要数据文件

### 常见问题及解决方案

#### 1. 程序启动问题
**问题**: 程序无法启动或闪退
**解决方案**:
- 检查 Python 环境是否正确安装
- 确认所有依赖包已安装
- 检查防火墙设置
- 以管理员身份运行

#### 2. 文件处理问题
**问题**: 文件无法打开或读取失败
**解决方案**:
- 检查文件是否被其他程序占用
- 确认文件格式为 `.xlsx` 或 `.xls`
- 检查文件是否损坏
- 尝试重新保存文件

**问题**: 处理过程中出现错误
**解决方案**:
- 检查数据格式是否符合要求
- 确认配置文件存在且格式正确
- 检查文件编码是否为 UTF-8
- 查看错误信息并相应调整

#### 3. 性能问题
**问题**: 处理大文件时速度慢或内存不足
**解决方案**:
- 关闭其他不必要的程序
- 增加系统内存
- 使用 SSD 硬盘
- 分批处理大文件

#### 4. 输出问题
**问题**: 输出文件格式不正确
**解决方案**:
- 检查输入数据格式
- 确认参数设置正确
- 重新处理文件
- 检查输出目录权限

#### 5. 二维码生成问题
**问题**: 二维码无法生成或显示异常
**解决方案**:
- 检查数据是否包含特殊字符
- 确认数据长度适合二维码
- 调整二维码参数
- 检查图像处理库是否正确安装

### 性能优化建议

#### 系统优化
- **内存管理**: 处理大文件时关闭其他程序释放内存
- **存储优化**: 使用 SSD 硬盘可显著提升处理速度
- **CPU 优化**: 确保 CPU 性能足够，避免过热降频

#### 文件处理优化
- **文件大小**: 建议单个文件不超过 50MB
- **数据清理**: 处理前清理不必要的空行和格式
- **分批处理**: 大文件可分批处理后合并

#### 程序优化
- **定期清理**: 定期清理临时文件和缓存
- **更新依赖**: 保持依赖包为最新版本
- **监控资源**: 使用任务管理器监控资源使用情况

#### 工作流程优化
- **标准化**: 建立标准的数据格式和命名规范
- **自动化**: 可考虑编写批处理脚本
- **备份策略**: 建立完善的文件备份机制

## 版本历史

### V4.0 (当前版本)
**发布日期**: 2024年
**主要特性**:
- **集成化设计**: 将多个独立工具整合为统一界面
- **现代化 UI**: 使用 ttk 主题，界面更加美观
- **拖拽支持**: 支持文件拖拽操作，提升用户体验
- **增强错误处理**: 完善的异常处理机制
- **优化算法**: 改进数据处理算法，提升性能
- **多语言支持**: 中文界面，适合国内用户

**功能模块**:
- 七号机压焊参数处理
- 拆板工具
- 分包工具
- 二维码整理
- 二维码整理（成品二）


### 兼容性

#### 操作系统兼容性
- **Windows 10**: 完全支持
- **Windows 11**: 完全支持
- **Windows 8.1**: 部分支持（可能存在问题）
- **Windows 7**: 不推荐使用（已停止支持）
- **其他系统**: 仅支持 Windows 系统

#### Excel 格式兼容性
- **Excel 2007+**: 完全支持 (.xlsx 格式)
- **Excel 97-2003**: 部分支持 (.xls 格式)
- **Excel 365**: 完全支持
- **WPS Office**: 部分支持（建议使用 Microsoft Excel）

#### Python 环境兼容性
- **Python 3.8+**: 推荐使用
- **Python 3.6-3.7**: 支持但可能有兼容性问题
- **Python 3.5 及以下**: 不支持
- **Python 2.x**: 不支持

#### 依赖包版本要求
| 包名 | 最低版本 | 推荐版本 |
|------|---------|---------|
| openpyxl | 3.0.0 | 3.1.0+ |
| pandas | 1.3.0 | 1.5.0+ |
| numpy | 1.21.0 | 1.24.0+ |
| qrcode | 7.3 | 7.4+ |
| Pillow | 8.0.0 | 9.5.0+ |
| tkinterdnd2 | 0.3.0 | 0.3.0+ |

## 技术支持

### 错误报告
如遇到问题，请提供以下信息：
- **错误信息**: 完整的错误信息和截图
- **输入文件**: 可重现问题的输入文件示例
- **系统环境**: 操作系统版本、Python 版本、依赖包版本
- **操作步骤**: 详细的操作步骤描述
- **期望结果**: 期望的正确结果

### 联系方式
- **技术支持**: 3324129290@qq.com
- **问题反馈**: 提交详细的错误报告
- **功能建议**: 欢迎提出改进建议

### 更新日志
#### V4.0 更新内容
- **新增功能**: 集成多个工具模块
- **界面改进**: 现代化 UI 设计
- **性能优化**: 提升处理速度和稳定性
- **错误修复**: 修复已知问题和兼容性问题


### 维护说明
- **定期更新**: 建议定期更新到最新版本
- **备份数据**: 重要数据请及时备份
- **测试环境**: 新版本建议在测试环境验证
- **文档更新**: 文档会随版本更新而更新

---

## 附录

### 数据格式参考
#### 压焊参数文件格式
```
列A: 产品编号
列B: 厚度
列C: 宽度
列D: 长度
列E: 重量
列F: 工艺参数
...
```

#### 拆板数据格式
```
列A: 产品编号
列B: 厚度
列C: 宽度
列D: 长度
列E: 间距
列F: 数量
...
```

#### 分包数据格式
```
列A: 产品编号
列B: 数量
列C: 长度
列D: 宽度
列E: 厚度
列F: 面积
列G: 重量
...
```

---

**注意**: 本工具专为九龙机械特定工业场景设计，使用前请确保理解相关业务逻辑和数据处理要求。如有疑问，请参考详细的使用说明或联系技术支持。
